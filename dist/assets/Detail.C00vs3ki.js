import{d as H,i as $,h as z,an as W,r as j,F as J,l as K,b as d,c as U,e as c,ag as Q,f as t,w as l,g as e,I as f,m,af as X,n as b,N as Y,ae as Z,j as g,bf as ee,B as _,S as ae,aj as q,q as k,M as te,E as le,ak as re,al as se,ai as x,_ as oe}from"./index.BVjvsxO0.js";import{o as ie}from"./onMountedOrActivated.Dd5Kvd6Q.js";import{c as ue,u as ne,d as de,a as ce}from"./index.BWQuoB1z.js";import{A as D}from"./index.DSggfTAH.js";import{a as pe,F as u}from"./index.s0lPGtcz.js";import{R as P}from"./index.DNiIFMvR.js";import{P as T}from"./PlusOutlined.DJ9P9naj.js";import{U as A,C as B}from"./index.DqosHAct.js";import{D as me}from"./DownloadOutlined.TlzuqQtv.js";import{R as ve,C as M}from"./index.DFrYayqQ.js";import"./collapseMotion.DqC5XeSW.js";import"./index.CVitLXsw.js";const y=h=>(re("data-v-fcfad22f"),h=h(),se(),h),fe={class:""},ge={class:"p-4 bg-white flex"},ye={key:0},be=y(()=>c("div",{style:{"margin-top":"8px"}},"Upload",-1)),_e=y(()=>c("div",{class:"mb-1 color-bluegray500"},"Title",-1)),he=y(()=>c("div",{class:"mb-1 color-bluegray500"},"Subtitle",-1)),je=y(()=>c("div",{class:"mb-1 color-bluegray500"},"Tax Type",-1)),Ue=y(()=>c("div",{class:"mb-1 color-bluegray500"},"Image",-1)),ke={key:0},Ie=y(()=>c("div",{style:{"margin-top":"8px"}},"Upload",-1)),Ce={class:"add-card"},we={class:"w-full flex justify-end"},Pe=H({__name:"Detail",setup(h){const S={Authorization:$().getToken},I=z(),C=W(),i=j(I.query.mode),s=j({title:"",subtitle:"",location:"",type:"completed",description:"",projectImages:[],materials:[]}),w=j(!1),v=j(!1),N=async()=>{const{id:o}=I.query;try{w.value=!0;const a=await ce(Number(o));s.value={...a,projectImages:x(a.projectImages),materials:a.materials.map(r=>({...r,image:x(r.image)}))}}catch(a){console.error(a)}finally{w.value=!1}},F=o=>{console.log(o.target.value),s.value.type=o.target.value},V={title:[{required:!0,message:"project title can not be empty",trigger:"change"}],subtitle:[{required:!0,message:"project subtitle can not be empty",trigger:"change"}],description:[{required:!0,message:"product description can not be empty",trigger:"change"}],location:[{required:!0,message:"product description can not be empty",trigger:"change"}],projectImages:[{type:"array",required:!0,trigger:"change",validator:async(o,a)=>a.length!=3?Promise.reject("Project images must be 3"):Promise.resolve()}],materials:[{type:"array",required:!0,trigger:"change",validator:async(o,a)=>a.length<1?Promise.reject("Project materials can not be empty"):Promise.resolve()}]},L=J(()=>{switch(i.value){case"add":return"Add Project";case"detail":return"Project Detail";case"edit":return"Update project";default:return""}}),O=()=>{s.value.materials.push({title:"",subtitle:"",taxType:"",image:[]})},R=o=>{s.value.materials.splice(o,1)},E=async()=>{var r;let o;const a={...s.value,projectImages:q((r=s.value)==null?void 0:r.projectImages),materials:s.value.materials.map(n=>({...n,image:q(n.image)}))};v.value=!0;try{i.value==="add"&&(o=await ue(a)),i.value==="edit"&&(o=await ne(a)),o?(k.success(i.value+" project successfully"),C.push({path:"/project",replace:!0})):k.error(i.value+"project failed")}catch(n){console.error(n)}finally{v.value=!1}},G=()=>{te.confirm({title:"Warning?",icon:t(le),content:"Are you sure you want to delete this project?",okButtonProps:{loading:v.value},onOk:async()=>{const{id:o}=I.query;try{v.value=!0,await de(Number(o))?(k.success("Delete project successfully"),C.push({path:"/product",replace:!0})):k.error("Delete project failed")}catch(a){console.error(a)}finally{v.value=!1}},onCancel(){}})};return K(async()=>{}),ie(async()=>{i.value!=="add"&&N()}),(o,a)=>(d(),U("div",fe,[c("h2",null,Q(L.value),1),c("div",ge,[t(e(ae),{wrapperClassName:"w-full",spinning:w.value},{default:l(()=>[t(e(pe),{name:"basic",class:"w-full p-4",rules:V,disabled:i.value==="detail","label-col":{style:{width:"150px"}},model:s.value,onFinish:E},{default:l(()=>[t(e(u),{label:"Title",name:"title"},{default:l(()=>[t(e(f),{value:s.value.title,"onUpdate:value":a[0]||(a[0]=r=>s.value.title=r),placeholder:"please enter"},null,8,["value"])]),_:1}),t(e(u),{label:"Subtitle",name:"subtitle"},{default:l(()=>[t(e(f),{value:s.value.subtitle,"onUpdate:value":a[1]||(a[1]=r=>s.value.subtitle=r),placeholder:"please enter"},null,8,["value"])]),_:1}),t(e(u),{label:"Type",name:"type"},{default:l(()=>[t(e(P).Group,{value:s.value.type,"onUpdate:value":a[2]||(a[2]=r=>s.value.type=r),"button-style":"solid",onChange:F},{default:l(()=>[t(e(P).Button,{value:"completed"},{default:l(()=>[m("Completed")]),_:1}),t(e(P).Button,{value:"onGoing"},{default:l(()=>[m("OnGoing")]),_:1})]),_:1},8,["value"])]),_:1}),t(e(u),{label:"Location",name:"location"},{default:l(()=>[t(e(f),{value:s.value.location,"onUpdate:value":a[3]||(a[3]=r=>s.value.location=r),placeholder:"please enter"},null,8,["value"])]),_:1}),t(e(u),{label:"Description",name:"description"},{default:l(()=>[t(e(X),{value:s.value.description,"onUpdate:value":a[4]||(a[4]=r=>s.value.description=r),placeholder:"please enter"},null,8,["value"])]),_:1}),t(e(u),{label:"Project Images",name:"projectImages"},{default:l(()=>[t(e(A),{headers:S,"file-list":s.value.projectImages,"onUpdate:fileList":a[5]||(a[5]=r=>s.value.projectImages=r),action:e(D).AntUpload,"list-type":"picture-card"},{default:l(()=>[s.value.projectImages&&s.value.projectImages.length<3?(d(),U("div",ye,[t(e(T)),be])):b("",!0)]),_:1},8,["file-list","action"])]),_:1}),t(e(u),{name:"materials",label:"Materials"},{default:l(()=>[t(e(ve),{gutter:[16,24]},{default:l(()=>[(d(!0),U(Y,null,Z(s.value.materials,(r,n)=>(d(),g(e(M),{span:6,key:n},{default:l(()=>[t(e(B),null,ee({default:l(()=>[t(e(u),{name:["materials",n,"title"],rules:{required:!0,message:"Missing title"}},{default:l(()=>[_e,t(e(f),{value:r.title,"onUpdate:value":p=>r.title=p,placeholder:"please enter"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),t(e(u),{name:["materials",n,"subtitle"],rules:{required:!0,message:"Missing subtitle"}},{default:l(()=>[he,t(e(f),{value:r.subtitle,"onUpdate:value":p=>r.subtitle=p,placeholder:"please enter"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),t(e(u),{name:["materials",n,"taxType"],rules:{required:!0,message:"Missing taxType"}},{default:l(()=>[je,t(e(f),{value:r.taxType,"onUpdate:value":p=>r.taxType=p,placeholder:"please enter"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),t(e(u),{name:["materials",n,"image"],rules:{required:!0,message:"Missing image"}},{default:l(()=>[Ue,t(e(A),{headers:S,"file-list":r.image,"onUpdate:fileList":p=>r.image=p,action:e(D).AntUpload,"list-type":"picture-card","max-count":1},{default:l(()=>[r.image&&r.image.length<1?(d(),U("div",ke,[t(e(T)),Ie])):b("",!0)]),_:2},1032,["file-list","onUpdate:fileList","action"])]),_:2},1032,["name"])]),_:2},[i.value!=="detail"?{name:"actions",fn:l(()=>[t(e(me),{key:"delete",onClick:p=>R(n)},null,8,["onClick"])]),key:"0"}:void 0]),1024)]),_:2},1024))),128)),s.value.materials.length<7?(d(),g(e(M),{key:0,span:6},{default:l(()=>[t(e(B),{class:"card-container",hoverable:"",bodyStyle:{width:"100%",height:"100%"},onClick:O},{default:l(()=>[c("div",Ce,[t(e(T))])]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1}),t(e(u),null,{default:l(()=>[c("div",we,[i.value!=="detail"?(d(),g(e(_),{key:0,class:"mr-2",type:"primary","html-type":"submit",loading:v.value},{default:l(()=>[m(" Submit ")]),_:1},8,["loading"])):(d(),g(e(_),{key:1,disabled:!1,type:"primary",onClick:a[6]||(a[6]=()=>{i.value="edit"}),class:"mr-2"},{default:l(()=>[m(" Edit ")]),_:1})),i.value!="add"?(d(),g(e(_),{key:2,disabled:!1,class:"mr-2",type:"primary",danger:"",onClick:a[7]||(a[7]=()=>{G()})},{default:l(()=>[m(" Delete ")]),_:1})):b("",!0),i.value!=="detail"?(d(),g(e(_),{key:3,class:"mr-2",onClick:a[8]||(a[8]=()=>{i.value="detail"})},{default:l(()=>[m(" Detail ")]),_:1})):b("",!0),t(e(_),{onClick:a[9]||(a[9]=r=>e(C).go(-1)),disabled:!1},{default:l(()=>[m("Go Back")]),_:1})])]),_:1})]),_:1},8,["disabled","model"])]),_:1},8,["spinning"])])]))}}),Ge=oe(Pe,[["__scopeId","data-v-fcfad22f"],["__file","E:/deloitte_project/bruno/cms-front-end/src/views/project/Detail.vue"]]);export{Ge as default};
